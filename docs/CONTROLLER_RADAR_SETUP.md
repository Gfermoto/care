# üîß C.A.R.E. - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ –∏ —Ä–∞–¥–∞—Ä–∞

## üéØ –û–±–∑–æ—Ä –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

C.A.R.E. —Å–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–æ—Å–æ–±–æ–≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞** —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç—ã
- **–†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞** —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- **–î–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞** —á–µ—Ä–µ–∑ ROS2 —Å–µ—Ä–≤–∏—Å—ã
- **Web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** –¥–ª—è ESP32

---

## üöÄ –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–∞—Ç—á–∏–∫–∞
```bash
cd /home/gfer/CARE
./infrastructure/scripts/configure_sensor.sh
```

**–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –¥–∞—Ç—á–∏–∫–∞:**
- **1) Mock CAN** - –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑ –∂–µ–ª–µ–∑–∞
- **2) –†–µ–∞–ª—å–Ω—ã–π CAN** - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∏–∑–∏—á–µ—Å–∫–∏–º —Ä–∞–¥–∞—Ä–æ–º

### 2. –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã
```bash
./start.sh
```

---

## üîß –î–µ—Ç–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### üì° **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞–¥–∞—Ä–∞ LD2450**

#### **UART –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```yaml
radar_config:
  uart_port: 2              # UART –Ω–æ–º–µ—Ä (ESP32: 2, STM32: 2)
  baud_rate: 256000         # –°–∫–æ—Ä–æ—Å—Ç—å UART
  data_bits: 8              # –ë–∏—Ç—ã –¥–∞–Ω–Ω—ã—Ö
  stop_bits: 1              # –°—Ç–æ–ø-–±–∏—Ç—ã
  parity: none              # –ß–µ—Ç–Ω–æ—Å—Ç—å
  flow_control: none        # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–æ–º
```

#### **–†–∞–¥–∞—Ä–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```yaml
radar_settings:
  max_targets: 3            # –ú–∞–∫—Å–∏–º—É–º —Ü–µ–ª–µ–π (1-3)
  detection_range: 8000      # –î–∞–ª—å–Ω–æ—Å—Ç—å –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è (–º–º)
  update_rate: 20            # –ß–∞—Å—Ç–æ—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–ì—Ü)
  sensitivity: medium        # –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (low/medium/high)
  motion_only: false         # –¢–æ–ª—å–∫–æ –¥–≤–∏–∂—É—â–∏–µ—Å—è –æ–±—ä–µ–∫—Ç—ã
```

#### **–ó–æ–Ω—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è:**
```yaml
detection_zones:
  zone_1:
    enabled: true
    start_angle: -60         # –ù–∞—á–∞–ª—å–Ω—ã–π —É–≥–æ–ª (–≥—Ä–∞–¥—É—Å—ã)
    end_angle: 60            # –ö–æ–Ω–µ—á–Ω—ã–π —É–≥–æ–ª (–≥—Ä–∞–¥—É—Å—ã)
    min_distance: 200       # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–∞–ª—å–Ω–æ—Å—Ç—å (–º–º)
    max_distance: 8000      # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–∞–ª—å–Ω–æ—Å—Ç—å (–º–º)
  
  zone_2:
    enabled: false
    start_angle: -30
    end_angle: 30
    min_distance: 500
    max_distance: 3000
```

---

## üéõÔ∏è **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞**

### **ESP32 –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:**

#### **CAN –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```yaml
can_config:
  bitrate: 500000           # –°–∫–æ—Ä–æ—Å—Ç—å CAN (–±–∏—Ç/—Å)
  tx_pin: 5                 # –ü–∏–Ω TX
  rx_pin: 4                 # –ü–∏–Ω RX
  termination: true         # –¢–µ—Ä–º–∏–Ω–∞—Ç–æ—Ä (120 –û–º)
  silent_mode: false        # –¢–∏—Ö–∏–π —Ä–µ–∂–∏–º
```

#### **WiFi –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:**
```yaml
wifi_config:
  ssid: "CARE_Controller"   # –ò–º—è —Å–µ—Ç–∏
  password: "care12345"     # –ü–∞—Ä–æ–ª—å
  ip: "192.168.4.1"        # IP –∞–¥—Ä–µ—Å
  port: 80                 # Web –ø–æ—Ä—Ç
  ap_mode: true            # –†–µ–∂–∏–º —Ç–æ—á–∫–∏ –¥–æ—Å—Ç—É–ø–∞
```

#### **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
```yaml
safety_config:
  emergency_radius: 1000    # –ê–≤–∞—Ä–∏–π–Ω–∞—è –∑–æ–Ω–∞ (–º–º)
  emergency_angle: 30       # –£–≥–æ–ª –∞–≤–∞—Ä–∏–π–Ω–æ–π –∑–æ–Ω—ã (¬±15¬∞)
  reaction_time: 50         # –í—Ä–µ–º—è —Ä–µ–∞–∫—Ü–∏–∏ (–º—Å)
  auto_reset: true          # –ê–≤—Ç–æ—Å–±—Ä–æ—Å –∞–≤–∞—Ä–∏–∏
  reset_delay: 5000        # –ó–∞–¥–µ—Ä–∂–∫–∞ —Å–±—Ä–æ—Å–∞ (–º—Å)
```

### **STM32 –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:**

#### **CAN –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```c
// STM32 CAN Configuration
#define CAN_BITRATE 500000
#define CAN_TX_PIN GPIO_PIN_0
#define CAN_RX_PIN GPIO_PIN_1
#define CAN_PORT GPIOB
```

#### **UART –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```c
// STM32 UART Configuration for LD2450
#define RADAR_UART UART2
#define RADAR_BAUDRATE 256000
#define RADAR_TX_PIN GPIO_PIN_2
#define RADAR_RX_PIN GPIO_PIN_3
#define RADAR_PORT GPIOA
```

---

## üåê **Web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (ESP32)**

### **–î–æ—Å—Ç—É–ø –∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É:**
1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ WiFi —Å–µ—Ç–∏ `CARE_Controller`
2. –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä: `http://192.168.4.1`
3. –í–æ–π–¥–∏—Ç–µ —Å –ø–∞—Ä–æ–ª–µ–º: `care12345`

### **–°—Ç—Ä–∞–Ω–∏—Ü—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
- **üì° Radar Settings** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞–¥–∞—Ä–∞
- **üîß Controller Config** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞  
- **üõ°Ô∏è Safety Zones** - –∑–æ–Ω—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **üìä Monitoring** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- **üíæ Save/Load** - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

---

## üîÑ **ROS2 —Å–µ—Ä–≤–∏—Å—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏**

### **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ ROS2:**
```bash
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CAN –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
ros2 service call /care/configure_controller \
  care_common/srv/ConfigController \
  "{device_id: 1, config_section: 'can', config_data: '{\"bitrate\": 500000, \"tx_pin\": 5, \"rx_pin\": 4}', apply_immediately: true, save_to_flash: true}"

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞–¥–∞—Ä–∞
ros2 service call /care/configure_controller \
  care_common/srv/ConfigController \
  "{device_id: 1, config_section: 'radar', config_data: '{\"max_targets\": 3, \"detection_range\": 8000, \"update_rate\": 20}', apply_immediately: true, save_to_flash: true}"

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
ros2 service call /care/configure_controller \
  care_common/srv/ConfigController \
  "{device_id: 1, config_section: 'safety', config_data: '{\"emergency_radius\": 1000, \"emergency_angle\": 30}', apply_immediately: true, save_to_flash: true}"
```

---

## üìã **–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏**

### **1. –ü—Ä–æ–≤–µ—Ä–∫–∞ CAN —à–∏–Ω—ã:**
```bash
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ CAN —Å–æ–æ–±—â–µ–Ω–∏–π
candump can0

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏
candump can0 -L

# –¢–µ—Å—Ç–æ–≤–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞
cansend can0 100#01
```

### **2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–¥–∞—Ä–∞:**
```bash
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ UART (–µ—Å–ª–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω –Ω–∞–ø—Ä—è–º—É—é)
sudo cat /dev/ttyUSB0 | hexdump -C

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ ROS2
ros2 topic echo /care/radar_targets
```

### **3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞:**
```bash
# –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã
ros2 topic echo /care/system_status

# CAN –º–æ—Å—Ç
ros2 topic echo /care/can_messages
```

---

## üîß **–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º**

### **–ü—Ä–æ–±–ª–µ–º–∞: CAN –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
ip link show can0

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CAN
sudo ip link set can0 up type can bitrate 500000

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ—Ä–º–∏–Ω–∞—Ç–æ—Ä–∞
sudo ip link set can0 down
sudo ip link set can0 up type can bitrate 500000
```

### **–ü—Ä–æ–±–ª–µ–º–∞: –†–∞–¥–∞—Ä –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ UART
ls -la /dev/ttyUSB*

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
sudo chmod 666 /dev/ttyUSB0

# –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
sudo minicom -D /dev/ttyUSB0 -b 256000
```

### **–ü—Ä–æ–±–ª–µ–º–∞: WiFi –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è**
```bash
# –°–±—Ä–æ—Å WiFi –Ω–∞ ESP32
# –£–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ –∫–Ω–æ–ø–∫—É RESET 10 —Å–µ–∫—É–Ω–¥

# –†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ç–∏ CARE_Controller
# IP: 192.168.4.1, –ø–∞—Ä–æ–ª—å: care12345
```

---

## üìä **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**

### **–õ–æ–≥–∏ —Å–∏—Å—Ç–µ–º—ã:**
```bash
# ROS2 –ª–æ–≥–∏
ros2 log list

# CAN –ª–æ–≥–∏
journalctl -u canbus

# –°–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏
dmesg | grep -i can
```

### **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
```bash
# –ß–∞—Å—Ç–æ—Ç–∞ CAN —Å–æ–æ–±—â–µ–Ω–∏–π
candump can0 | pv -l > /dev/null

# –ó–∞–¥–µ—Ä–∂–∫–∏
ros2 topic hz /care/radar_targets
```

---

## üéØ **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏**

### **–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**
```yaml
test_config:
  sensor_type: mock
  can_bitrate: 500000
  emergency_radius: 2000    # 2–º –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
  update_rate: 10          # 10 –ì—Ü –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
```

### **–î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:**
```yaml
production_config:
  sensor_type: real
  can_bitrate: 1000000     # 1 –ú–±–∏—Ç/—Å
  emergency_radius: 1000   # 1–º –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –∑–æ–Ω–∞
  update_rate: 20          # 20 –ì—Ü –¥–ª—è —Ç–æ—á–Ω–æ—Å—Ç–∏
  redundancy: true         # –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ
```

---

## üéâ **–ì–æ—Ç–æ–≤–æ!**

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ C.A.R.E. –±—É–¥–µ—Ç:
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—Ç—å** –æ–±—ä–µ–∫—Ç—ã –≤ —Ä–∞–¥–∏—É—Å–µ 8–º
- ‚úÖ **–ú–≥–Ω–æ–≤–µ–Ω–Ω–æ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å** –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å–∏—Ç—É–∞—Ü–∏–∏
- ‚úÖ **–ü–µ—Ä–µ–¥–∞–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ** –≤ CAN —à–∏–Ω—É —Å —á–∞—Å—Ç–æ—Ç–æ–π 20 –ì—Ü
- ‚úÖ **–ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ** —á–µ—Ä–µ–∑ ROS2 –∏ Web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

**C.A.R.E. —Å–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ!** üõ°Ô∏è‚ú®
