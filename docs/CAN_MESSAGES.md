# üì° C.A.R.E. CAN –°–æ–æ–±—â–µ–Ω–∏—è - –ü–æ–ª–Ω—ã–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫

## üéØ –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã

C.A.R.E. –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —É–ø—Ä–æ—â–µ–Ω–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É CAN —Å–æ–æ–±—â–µ–Ω–∏–π —Å –ª–æ–≥–∏—á–Ω–æ–π –Ω—É–º–µ—Ä–∞—Ü–∏–µ–π:
- **0x100**: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è (Emergency Stop)
- **0x200-0x202**: –î–∞–Ω–Ω—ã–µ —Ü–µ–ª–µ–π (Target 0, 1, 2)
- **0x300**: –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã (System Status)
- **0x400+**: –†–µ–∑–µ—Ä–≤ –¥–ª—è –±—É–¥—É—â–∏—Ö —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π

## üö® ID 0x100 - Emergency Stop (–ê–≤–∞—Ä–∏–π–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞)

### –§–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏—è:
```
CAN ID: 0x100
DLC: 1 –±–∞–π—Ç
Data: [COMMAND]
```

### –ö–æ–º–∞–Ω–¥—ã:
- `0x01` - STOP (–∞–≤–∞—Ä–∏–π–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞)
- `0x00` - GO (—Ä–∞–∑—Ä–µ—à–∏—Ç—å –¥–≤–∏–∂–µ–Ω–∏–µ)

### –ü—Ä–∏–º–µ—Ä—ã:
```
0x100#01  # –ê–≤–∞—Ä–∏–π–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ê–ö–¢–ò–í–ù–ê
0x100#00  # –ê–≤–∞—Ä–∏–π–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ù–ï –ê–ö–¢–ò–í–ù–ê
```

### –£—Å–ª–æ–≤–∏—è —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è:
- –û–±—ä–µ–∫—Ç –±–ª–∏–∂–µ 1000–º–º (1–º)
- –£–≥–æ–ª –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö ¬±15¬∞
- –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è —Ä–µ–∞–∫—Ü–∏—è (< 1–º—Å)

---

## üéØ ID 0x200-0x202 - Target Data (–î–∞–Ω–Ω—ã–µ —Ü–µ–ª–µ–π)

### –§–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏—è:
```
CAN ID: 0x200 + target_id (0-2)
DLC: 8 –±–∞–π—Ç
Data: [ID_H, ID_L, X_H, X_L, Y_H, Y_L, DIST_H, DIST_L]
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:
- **ID_H, ID_L**: ID —Ü–µ–ª–∏ (16 –±–∏—Ç)
- **X_H, X_L**: X –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ –≤ –º–º (16 –±–∏—Ç, –∑–Ω–∞–∫–æ–≤–æ–µ)
- **Y_H, Y_L**: Y –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ –≤ –º–º (16 –±–∏—Ç, –∑–Ω–∞–∫–æ–≤–æ–µ)
- **DIST_H, DIST_L**: –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –≤ –º–º (16 –±–∏—Ç, –±–µ–∑–∑–Ω–∞–∫–æ–≤–æ–µ)

### –ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:

#### –¶–µ–ª—å #0 (ID 0x200):
```
0x200#0001006400C80000
```
**–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞:**
- ID —Ü–µ–ª–∏: 1
- X: 100–º–º
- Y: 200–º–º
- –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ: 0–º–º (–∫—Ä–∏—Ç–∏—á–Ω–æ!)

#### –¶–µ–ª—å #1 (ID 0x201):
```
0x201#0002007D00FA03E8
```
**–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞:**
- ID —Ü–µ–ª–∏: 2
- X: 125–º–º
- Y: 250–º–º
- –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ: 1000–º–º (1–º)

#### –¶–µ–ª—å #2 (ID 0x202):
```
0x202#00030096012C07D0
```
**–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞:**
- ID —Ü–µ–ª–∏: 3
- X: 150–º–º
- Y: 300–º–º
- –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ: 2000–º–º (2–º)

---

## üìä ID 0x300 - System Status (–°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã)

### –§–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏—è:
```
CAN ID: 0x300
DLC: 2 –±–∞–π—Ç–∞
Data: [ACTIVE_TARGETS, EMERGENCY_STATUS]
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:
- **ACTIVE_TARGETS**: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ü–µ–ª–µ–π (0-3)
- **EMERGENCY_STATUS**: –°—Ç–∞—Ç—É—Å –∞–≤–∞—Ä–∏–π–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ (0/1)

### –ü—Ä–∏–º–µ—Ä—ã:

#### –ù–æ—Ä–º–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞:
```
0x300#0300
```
**–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞:**
- –ê–∫—Ç–∏–≤–Ω—ã—Ö —Ü–µ–ª–µ–π: 3
- –ê–≤–∞—Ä–∏–π–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞: –ù–ï –ê–ö–¢–ò–í–ù–ê

#### –ê–≤–∞—Ä–∏–π–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:
```
0x300#0201
```
**–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞:**
- –ê–∫—Ç–∏–≤–Ω—ã—Ö —Ü–µ–ª–µ–π: 2
- –ê–≤–∞—Ä–∏–π–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞: –ê–ö–¢–ò–í–ù–ê

---

## üß© ID 0x400/0x401 ‚Äî –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (—á–µ—Ä–µ–∑ CAN)

### 0x400 ‚Äî –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞
```
CAN ID: 0x400
DLC: 8 –±–∞–π—Ç (TLV/Keyed)
Data: [CMD, K1, V1, K2, V2, K3, V3, FLAGS]
```
- CMD: 0x01=SET, 0x02=GET, 0x03=SAVE, 0x04=RESET
- K/V: –∫–æ–º–ø–∞–∫—Ç–Ω—ã–µ –∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–∏–µ (–ø—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –∫–ª—é—á–∏)
  - K=0x10 bitrate ‚Üí V: 0x00=125k, 0x01=250k, 0x02=500k, 0x03=1M
  - K=0x11 mode ‚Üí V: 0x00=normal, 0x01=silent

–ü—Ä–∏–º–µ—Ä—ã:
```
0x400#0110021100FF0000   # SET bitrate=500k (0x02), mode=normal (0x00), SAVE=0
0x400#0300000000000000   # SAVE –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
0x400#0400000000000000   # RESET –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞
```

### 0x401 ‚Äî –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞–¥–∞—Ä–∞
```
CAN ID: 0x401
DLC: 8 –±–∞–π—Ç (TLV/Keyed)
Data: [CMD, K1, V1, K2, V2, K3, V3, FLAGS]
```
- –ö–ª—é—á–∏:
  - K=0x20 max_targets ‚Üí V: 1..3
  - K=0x21 range_m ‚Üí V: 1..10 (–∫–º) –∏–ª–∏ –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–∫–∏
  - K=0x22 update_hz ‚Üí V: 10/20/50
  - K=0x23 sensitivity ‚Üí V: 0=low,1=med,2=high

–ü—Ä–∏–º–µ—Ä—ã:
```
0x401#012002210820011000  # SET max_targets=3, range=8–º, update=20–ì—Ü
0x401#032000000000000000  # SAVE
```

### ACK/ERROR –æ—Ç–≤–µ—Ç—ã
```
0x480#00AA000000000000    # ACK –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ (AA=–∫–æ–¥ —É—Å–ø–µ—Ö–∞)
0x481#01E1000000000000    # ERROR —Ä–∞–¥–∞—Ä–∞ (E1=–∫–æ–¥ –æ—à–∏–±–∫–∏)
```

–ù–æ–¥—ã –ø—É–±–ª–∏–∫—É—é—Ç —Å—ã—Ä—ã–µ ACK –≤ —Ç–æ–ø–∏–∫ `/care/config_ack_raw` (–º–æ—Å—Ç).

---

## üîÑ –ü–æ–ª–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –ø–æ—Ç–æ–∫–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π (–¥–æ–ø–æ–ª–Ω–µ–Ω–æ)

### –ù–æ—Ä–º–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ (3 —Ü–µ–ª–∏):
```
0x200#0001006400C80000  # –¶–µ–ª—å 1: (100, 200)–º–º, 0–º–º
0x201#0002007D00FA03E8  # –¶–µ–ª—å 2: (125, 250)–º–º, 1000–º–º
0x202#00030096012C07D0  # –¶–µ–ª—å 3: (150, 300)–º–º, 2000–º–º
0x300#0300              # –°—Ç–∞—Ç—É—Å: 3 —Ü–µ–ª–∏, –∞–≤–∞—Ä–∏—è –ù–ï–¢
```

### –ê–≤–∞—Ä–∏–π–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:
```
0x100#01                # üö® EMERGENCY STOP!
0x200#0001006400C80000  # –¶–µ–ª—å 1: (100, 200)–º–º, 0–º–º - –ö–†–ò–¢–ò–ß–ù–û!
0x201#0002007D00FA03E8  # –¶–µ–ª—å 2: (125, 250)–º–º, 1000–º–º
0x202#00030096012C07D0  # –¶–µ–ª—å 3: (150, 300)–º–º, 2000–º–º
0x300#0301              # –°—Ç–∞—Ç—É—Å: 3 —Ü–µ–ª–∏, –∞–≤–∞—Ä–∏—è –ê–ö–¢–ò–í–ù–ê
```

### –ß–∞—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ (1 —Ü–µ–ª—å):
```
0x200#0001006400C80000  # –¶–µ–ª—å 1: (100, 200)–º–º, 0–º–º
0x300#0100              # –°—Ç–∞—Ç—É—Å: 1 —Ü–µ–ª—å, –∞–≤–∞—Ä–∏—è –ù–ï–¢
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ —á–µ—Ä–µ–∑ CAN
```
0x400#0110021100FF0000  # SET
0x480#00AA000000000000  # ACK
0x400#0300000000000000  # SAVE
0x480#00AA000000000000  # ACK
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞–¥–∞—Ä–∞ —á–µ—Ä–µ–∑ CAN
```
0x401#012002210820011000 # SET
0x481#00AA000000000000   # ACK
```

---

## üîÑ –ü—Ä–∏–º–µ—Ä—ã –∫–æ–º–∞–Ω–¥ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### GET –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞
```
0x400#0200000000000000  # CMD=GET
0x480#00AA000000000000  # ACK
```

### RESET —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Ä–∞–¥–∞—Ä–∞
```
0x401#0400000000000000  # CMD=RESET
0x481#00AA000000000000  # ACK
```

## ‚ö° –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –ø–µ—Ä–µ–¥–∞—á–∏

### –ß–∞—Å—Ç–æ—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏–π:
- **Emergency Stop**: –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ –ø—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏
- **Target Data**: 20 –ì—Ü (–∫–∞–∂–¥—ã–µ 50–º—Å)
- **System Status**: 10 –ì—Ü (–∫–∞–∂–¥—ã–µ 100–º—Å)

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã:
1. **0x100** - Emergency Stop (–≤—ã—Å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
2. **0x200-0x202** - Target Data (—Å—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
3. **0x300** - System Status (–Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

### –ó–∞–¥–µ—Ä–∂–∫–∏:
- **Emergency Stop**: < 1–º—Å
- **Target Data**: < 10–º—Å
- **System Status**: < 50–º—Å

---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ –æ—Ç–ª–∞–¥–∫–∞

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ CAN —à–∏–Ω—ã:
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π C.A.R.E.
candump can0 | grep -E "100|200|201|202|300"

# –¢–æ–ª—å–∫–æ –∞–≤–∞—Ä–∏–π–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
candump can0 | grep "100"

# –¢–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ —Ü–µ–ª–µ–π
candump can0 | grep -E "200|201|202"
```

### –û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π:
```bash
# –ê–≤–∞—Ä–∏–π–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞
cansend can0 100#01

# –¢–µ—Å—Ç–æ–≤–∞—è —Ü–µ–ª—å
cansend can0 200#0001006400C80000

# –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã
cansend can0 300#0300
```

---

## üìã –°–ø—Ä–∞–≤–æ—á–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ CAN ID

| ID | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | DLC | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –ß–∞—Å—Ç–æ—Ç–∞ |
|----|------------|-----|-----------|---------|
| 0x100 | Emergency Stop | 1 | –í—ã—Å—à–∏–π | –ü–æ —Å–æ–±—ã—Ç–∏—é |
| 0x200 | Target 0 Data | 8 | –°—Ä–µ–¥–Ω–∏–π | 20 –ì—Ü |
| 0x201 | Target 1 Data | 8 | –°—Ä–µ–¥–Ω–∏–π | 20 –ì—Ü |
| 0x202 | Target 2 Data | 8 | –°—Ä–µ–¥–Ω–∏–π | 20 –ì—Ü |
| 0x300 | System Status | 2 | –ù–∏–∑–∫–∏–π | 10 –ì—Ü |
| 0x400 | Config Controller | 8 | –ù–∏–∑–∫–∏–π | –ü–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é |
| 0x401 | Config Radar | 8 | –ù–∏–∑–∫–∏–π | –ü–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é |
| 0x480 | ACK Controller | 8 | –ù–∏–∑–∫–∏–π | –ü–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é |
| 0x481 | ACK Radar | 8 | –ù–∏–∑–∫–∏–π | –ü–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é |

---

## üéØ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–≠—Ç–∞ —Å–∏—Å—Ç–µ–º–∞ CAN —Å–æ–æ–±—â–µ–Ω–∏–π –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
- ‚úÖ **–ü—Ä–æ—Å—Ç–æ—Ç–∞**: –õ–æ–≥–∏—á–Ω–∞—è –Ω—É–º–µ—Ä–∞—Ü–∏—è –∏ –ø–æ–Ω—è—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- ‚úÖ **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**: –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –∏ –±—ã—Å—Ç—Ä—ã–µ —Ä–µ–∞–∫—Ü–∏–∏
- ‚úÖ **–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å**: –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Ä–∞–¥–∞—Ä–∞ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è
- ‚úÖ **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å**: –†–µ–∑–µ—Ä–≤ –¥–ª—è –±—É–¥—É—â–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π

**C.A.R.E. CAN —Å–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ!** üõ°Ô∏è
