# C.A.R.E. Troubleshooting Guide - –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

## üîç –ü—Ä–æ–±–ª–µ–º–∞: "–ù–µ –≤–∏–∂—É —Ü–µ–ª–∏ –≤ RViz2"

### ‚úÖ –†–µ—à–µ–Ω–∏–µ –Ω–∞–π–¥–µ–Ω–æ!

–ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ –≤ TF —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è—Ö –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ timestamps. –í–æ—Ç —á—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

#### üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ–¥–µ:
1. **–î–æ–±–∞–≤–ª–µ–Ω StaticTransformBroadcaster** –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π
2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏—è –º–∞—Ä–∫–µ—Ä–æ–≤** - —É–±—Ä–∞–Ω –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å –º–∞—Å—Å–∏–≤–∞
3. **–£–ª—É—á—à–µ–Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è timestamps** –º–µ–∂–¥—É TF –∏ –º–∞—Ä–∫–µ—Ä–∞–º–∏
4. **–î–æ–±–∞–≤–ª–µ–Ω—ã –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ –ª–æ–≥–∏** –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

#### üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã:
```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–ø–∏–∫–æ–≤
ros2 topic list | grep care
# –î–æ–ª–∂–Ω—ã –±—ã—Ç—å:
# /care/radar_targets
# /care/safety_zone  
# /care/fov_visualization
# /care/status

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ TF
ros2 run tf2_ros tf2_echo map radar_link
# –î–æ–ª–∂–Ω–∞ –ø–æ–∫–∞–∑–∞—Ç—å —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—é 0.2m –ø–æ X, 0.1m –ø–æ Z

# 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Ü–µ–ª–µ–π
ros2 topic echo /care/radar_targets --once
# –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –º–∞—Ä–∫–µ—Ä—ã —Å –ø–æ–∑–∏—Ü–∏—è–º–∏ –∏ —Ü–≤–µ—Ç–∞–º–∏

# 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ FoV
ros2 topic echo /care/fov_visualization --once  
# –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π –∏ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π FoV
```

## üéØ –°–∏–º–ø—Ç–æ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞: "Message Filter dropping message"
**–°–∏–º–ø—Ç–æ–º—ã**: –í –ª–æ–≥–∞—Ö RViz2 –æ—à–∏–±–∫–∏ —Ç–∏–ø–∞:
```
[INFO] [rviz]: Message Filter dropping message: frame 'radar_link' at time ... 
for reason 'the timestamp on the message is earlier than all the data in the transform cache'
```

**–†–µ—à–µ–Ω–∏–µ**: ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**
- –î–æ–±–∞–≤–ª–µ–Ω `StaticTransformBroadcaster` 
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã timestamps –º–µ–∂–¥—É TF –∏ –º–∞—Ä–∫–µ—Ä–∞–º–∏
- TF –ø—É–±–ª–∏–∫—É—é—Ç—Å—è –Ω–∞ —á–∞—Å—Ç–æ—Ç–µ 20Hz

### –ü—Ä–æ–±–ª–µ–º–∞: "–ù–µ—Ç —Ü–µ–ª–µ–π –≤ RViz2"
**–°–∏–º–ø—Ç–æ–º—ã**: 
- –¢–æ–ø–∏–∫–∏ –ø—É–±–ª–∏–∫—É—é—Ç—Å—è
- TF —Ä–∞–±–æ—Ç–∞–µ—Ç
- –ù–æ –º–∞—Ä–∫–µ—Ä—ã –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ**: ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ –≤ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –º–∞—Å—Å–∏–≤–∞ –º–∞—Ä–∫–µ—Ä–æ–≤
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø—É–±–ª–∏–∫–∞—Ü–∏—è `safety_marker` –≤–º–µ—Å—Ç–æ `marker_array.markers[2]`

### –ü—Ä–æ–±–ª–µ–º–∞: "FoV –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è"
**–°–∏–º–ø—Ç–æ–º—ã**: –ì—Ä–∞–Ω–∏—Ü—ã –ø–æ–ª—è –∑—Ä–µ–Ω–∏—è –Ω–µ –≤–∏–¥–Ω—ã

**–†–µ—à–µ–Ω–∏–µ**: ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**
- –°–æ–∑–¥–∞–Ω –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ç–æ–ø–∏–∫ `/care/fov_visualization`
- –î–æ–±–∞–≤–ª–µ–Ω MarkerArray –¥–∏—Å–ø–ª–µ–π –≤ RViz2 –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ü–≤–µ—Ç–∞: –≥–æ–ª—É–±–æ–π –¥–ª—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ, –∑–µ–ª–µ–Ω—ã–π –¥–ª—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–≥–æ FoV

## üõ†Ô∏è –û—Ç–ª–∞–¥–æ—á–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –ë—ã—Å—Ç—Ä–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:
```bash
# –ó–∞–ø—É—Å–∫ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞
./infrastructure/scripts/debug_care.sh

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
./infrastructure/scripts/monitor_care.sh
```

### –ü–æ—à–∞–≥–æ–≤–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:
```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ ROS2 –æ–∫—Ä—É–∂–µ–Ω–∏—è
echo $ROS_DISTRO  # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: jazzy

# 2. –°–±–æ—Ä–∫–∞ –ø–∞–∫–µ—Ç–∞
cd services/ros2
colcon build --packages-select care_radar_publisher

# 3. –ó–∞–ø—É—Å–∫ –Ω–æ–¥—ã
ros2 run care_radar_publisher care_radar_node

# 4. –í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–ø–∏–∫–æ–≤
ros2 topic list | grep care

# 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö
ros2 topic echo /care/status --once
ros2 topic echo /care/radar_targets --once

# 6. –ó–∞–ø—É—Å–∫ RViz2
rviz2 -d services/ros2/care_radar_publisher/config/care_radar.rviz
```

## üé® –ù–∞—Å—Ç—Ä–æ–π–∫–∞ RViz2

### –ï—Å–ª–∏ –Ω–µ –≤–∏–¥–Ω–æ –º–∞—Ä–∫–µ—Ä–æ–≤:
1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å Fixed Frame**: –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `map`
2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–ø–∏–∫–∏**: 
   - `/care/radar_targets` ‚Üí MarkerArray
   - `/care/safety_zone` ‚Üí Marker
   - `/care/fov_visualization` ‚Üí MarkerArray
3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å Namespaces**: –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤–∫–ª—é—á–µ–Ω—ã –≤—Å–µ namespace'—ã

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞–º–µ—Ä—ã:
- **Distance**: 4-6 –º–µ—Ç—Ä–æ–≤
- **Pitch**: 0.5-0.8 —Ä–∞–¥–∏–∞–Ω
- **Yaw**: 0 —Ä–∞–¥–∏–∞–Ω  
- **Target Frame**: `radar_link`

## üìà –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ

### –¶–µ–ª–∏ —Ä–∞–¥–∞—Ä–∞:
- –ü–æ—è–≤–ª—è—é—Ç—Å—è –∫–∞—Å–∫–∞–¥–Ω–æ —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º 1 —Å–µ–∫—É–Ω–¥–∞
- –ñ–∏–≤—É—Ç 5 —Å–µ–∫—É–Ω–¥ —Å –ø–ª–∞–≤–Ω—ã–º –¥–≤–∏–∂–µ–Ω–∏–µ–º
- –ò—Å—á–µ–∑–∞—é—Ç –Ω–∞ 2 —Å–µ–∫—É–Ω–¥—ã
- –¶–≤–µ—Ç–∞: üî¥ –æ–ø–∞—Å–Ω—ã–µ, üü° –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ, üü¢ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ

### FoV –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:
- üîµ **–ì–æ–ª—É–±—ã–µ –ª–∏–Ω–∏–∏**: –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π FoV (60¬∞)
- üü¢ **–ó–µ–ª–µ–Ω—ã–µ –ª–∏–Ω–∏–∏**: –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π FoV (35¬∞)
- üî¥ **–ö—Ä–∞—Å–Ω—ã–µ –ª–∏–Ω–∏–∏**: –ó–æ–Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (1.5–º)

### –ß–∞—Å—Ç–æ—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:
- **–¶–µ–ª–∏**: 10 Hz
- **TF**: 20 Hz
- **FoV**: 10 Hz
- **–°—Ç–∞—Ç—É—Å**: 10 Hz

## üö® –ê–≤–∞—Ä–∏–π–Ω—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏

### –ï—Å–ª–∏ —Å–∏—Å—Ç–µ–º–∞ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:
```bash
# –£–±–∏—Ç—å –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
pkill -f care_radar_node
pkill -f rviz2

# –û—á–∏—Å—Ç–∏—Ç—å —Å–±–æ—Ä–∫—É
cd services/ros2
rm -rf build install log

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å
colcon build --packages-select care_radar_publisher

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
./infrastructure/scripts/launch_care_demo.sh
```

### –ï—Å–ª–∏ RViz2 –∑–∞–≤–∏—Å–∞–µ—Ç:
```bash
# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ RViz2 —Å —á–∏—Å—Ç–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
pkill -f rviz2
rviz2
```

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –≤—Å–µ—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ:
- ‚úÖ –¶–µ–ª–∏ –ø–æ—è–≤–ª—è—é—Ç—Å—è –∏ –¥–≤–∏–∂—É—Ç—Å—è —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ
- ‚úÖ FoV –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (60¬∞ √ó 35¬∞)
- ‚úÖ TF —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Å—Ç–∞–±–∏–ª—å–Ω—ã
- ‚úÖ –ó–æ–Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤–∏–¥–Ω–∞
- ‚úÖ –¶–≤–µ—Ç–æ–≤–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ö–∞—Å–∫–∞–¥–Ω–æ–µ –ø–æ—è–≤–ª–µ–Ω–∏–µ —Ü–µ–ª–µ–π (1 —Å–µ–∫ –∏–Ω—Ç–µ—Ä–≤–∞–ª)
- ‚úÖ –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª 5 —Å–µ–∫ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å + 2 —Å–µ–∫ –ø–∞—É–∑–∞

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –¥–∞–ª—å–Ω–µ–π—à–µ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏!** üéØ

