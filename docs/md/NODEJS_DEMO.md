# üü¢ C.A.R.E. Node.js Demo

–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è Node.js –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ C.A.R.E. —Å Mock –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

### –ó–∞–ø—É—Å–∫ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤ –æ–¥–Ω–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ
./scripts/launch_nodejs_demo.sh
```

### –ó–∞–ø—É—Å–∫ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

```bash
cd services/nodejs

# Mock CAN Interface
node mock-can/index.js

# Web Dashboard
node care-dashboard/index.js

# API Server
node care-api/index.js
```

## üåê –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã:

- **Web Dashboard**: http://localhost:3000
  - Real-time –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ü–µ–ª–µ–π —Ä–∞–¥–∞—Ä–∞
  - –°—Ç–∞—Ç—É—Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (Emergency Stop)
  - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã
  - WebSocket –¥–ª—è live –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

- **API Server**: http://localhost:3001
  - REST API –¥–ª—è –¥–∞–Ω–Ω—ã—Ö —Ä–∞–¥–∞—Ä–∞
  - –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö (JSON/CSV)
  - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
  - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã

## üéØ Mock CAN Interface

### –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ

- **3 –¥–≤–∏–∂—É—â–∏–µ—Å—è —Ü–µ–ª–∏** —Å —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–π —Ñ–∏–∑–∏–∫–æ–π
- **Emergency Stop** –ø—Ä–∏ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–∏ < 500mm
- **CAN —Å–æ–æ–±—â–µ–Ω–∏—è** –∫–∞–∂–¥—ã–µ 100–º—Å
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥

### CAN ID Mapping

| ID | –û–ø–∏—Å–∞–Ω–∏–µ | –î–∞–Ω–Ω—ã–µ |
|----|----------|--------|
| 0x100 | Emergency Stop | [0x01/0x00] |
| 0x200 | Target 0 | [x_high, x_low, y_high, y_low, dist_high, dist_low, speed_high, speed_low] |
| 0x201 | Target 1 | [x_high, x_low, y_high, y_low, dist_high, dist_low, speed_high, speed_low] |
| 0x202 | Target 2 | [x_high, x_low, y_high, y_low, dist_high, dist_low, speed_high, speed_low] |
| 0x300 | System Status | [status, active_targets, safety_dist_high, safety_dist_low] |

## üìä Web Dashboard

### –§—É–Ω–∫—Ü–∏–∏

- **Radar Display** - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ü–µ–ª–µ–π –Ω–∞ —Ä–∞–¥–∏–∞–ª—å–Ω–æ–π —Å–µ—Ç–∫–µ
- **Safety Status** - —Å—Ç–∞—Ç—É—Å Emergency Stop –∏ –∑–æ–Ω –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **System Statistics** - uptime, —Å–æ–æ–±—â–µ–Ω–∏—è, –æ—à–∏–±–∫–∏
- **Real-time Updates** - WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ

### –¶–≤–µ—Ç–æ–≤–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è —Ü–µ–ª–µ–π

- üü¢ **–ó–µ–ª–µ–Ω—ã–π** - –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ (>1000mm)
- üü° **–ñ–µ–ª—Ç—ã–π** - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ (500-1000mm)  
- üî¥ **–ö—Ä–∞—Å–Ω—ã–π** - –æ–ø–∞—Å–Ω–æ—Å—Ç—å (<500mm)

## üîå API Endpoints

### –†–∞–¥–∞—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

```bash
# –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Ä–∞–¥–∞—Ä–∞
GET /api/radar/data?limit=100&offset=0

# –ó–∞–ø–∏—Å–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —Ä–∞–¥–∞—Ä–∞
POST /api/radar/data
{
  "target_id": 0,
  "x": 1000,
  "y": 500,
  "distance": 1118,
  "speed": 50,
  "valid": true
}
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

```bash
# –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
GET /api/config/safety

# –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
POST /api/config/safety
{
  "min_safe_distance": 500,
  "max_safe_distance": 5000,
  "safety_angle": 30,
  "emergency_stop_enabled": true
}
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

```bash
# –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
GET /api/statistics

# Health check
GET /health
```

### –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö

```bash
# JSON —ç–∫—Å–ø–æ—Ä—Ç
GET /api/export/radar?format=json&date=2024-01-15

# CSV —ç–∫—Å–ø–æ—Ä—Ç
GET /api/export/radar?format=csv&date=2024-01-15
```

## üéÆ –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### WebSocket Protocol

Dashboard –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç JSON —Å–æ–æ–±—â–µ–Ω–∏—è –∫–∞–∂–¥—ã–µ 100–º—Å:

```json
{
  "type": "radar",
  "data": {
    "targets": [
      {
        "id": 0,
        "x": 1000,
        "y": 500,
        "distance": 1118,
        "speed": 50,
        "valid": true
      }
    ],
    "activeTargets": 3,
    "lastUpdate": "2024-01-15T12:00:00.000Z"
  },
  "timestamp": "2024-01-15T12:00:00.000Z"
}
```

### –¢–∏–ø—ã —Å–æ–æ–±—â–µ–Ω–∏–π

- `initial_data` - –Ω–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏
- `radar` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ä–∞–¥–∞—Ä–∞
- `safety` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- `system` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- `statistics` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

## üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
Mock CAN Interface ‚Üí Shared Data ‚Üí Web Dashboard
                    ‚Üì
                  API Server ‚Üê Data Storage
```

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- **express** - –≤–µ–±-—Å–µ—Ä–≤–µ—Ä
- **ws** - WebSocket
- **moment** - —Ä–∞–±–æ—Ç–∞ —Å –¥–∞—Ç–∞–º–∏
- **csv-writer** - —ç–∫—Å–ø–æ—Ä—Ç CSV
- **helmet** - –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å HTTP
- **cors** - Cross-Origin Resource Sharing

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **–û–±–Ω–æ–≤–ª–µ–Ω–∏—è**: 100–º—Å (10 FPS)
- **CAN —Å–æ–æ–±—â–µ–Ω–∏—è**: ~30 —Å–æ–æ–±—â–µ–Ω–∏–π/—Å–µ–∫
- **WebSocket**: Real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- **–ü–∞–º—è—Ç—å**: ~50MB –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### Environment Variables

```bash
# –ü–æ—Ä—Ç—ã —Å–µ—Ä–≤–∏—Å–æ–≤
PORT=3000                    # Dashboard port
API_PORT=3001               # API port

# Mock CAN –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
TARGET_COUNT=3              # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ü–µ–ª–µ–π
UPDATE_INTERVAL=100         # –ò–Ω—Ç–µ—Ä–≤–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (–º—Å)
SAFETY_ZONE_MIN=500         # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –¥–∏—Å—Ç–∞–Ω—Ü–∏—è (–º–º)
SAFETY_ZONE_MAX=8000        # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–∏—Å—Ç–∞–Ω—Ü–∏—è (–º–º)
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Mock CAN

```javascript
const mockCAN = new MockCANInterface({
    targetCount: 3,
    updateInterval: 100,
    safetyZone: {
        minDistance: 500,
        maxDistance: 8000,
        angleRange: 120
    }
});
```

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏

- **Mock CAN**: –∫–æ–Ω—Å–æ–ª—å–Ω—ã–π –≤—ã–≤–æ–¥ + —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- **Dashboard**: HTTP access logs
- **API**: HTTP access logs + –æ—à–∏–±–∫–∏

### –ú–µ—Ç—Ä–∏–∫–∏

- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ CAN —Å–æ–æ–±—â–µ–Ω–∏–π
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- –í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞ API
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏

### Health Checks

```bash
# Dashboard health
curl http://localhost:3000/health

# API health  
curl http://localhost:3001/health

# Statistics
curl http://localhost:3001/api/statistics
```

## üö® Troubleshooting

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **–ü–æ—Ä—Ç –∑–∞–Ω—è—Ç**
   ```bash
   # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã
   lsof -i :3000
   lsof -i :3001
   
   # –£–±–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã
   pkill -f "node.*integrated-demo"
   ```

2. **WebSocket –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å firewall
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±—Ä–∞—É–∑–µ—Ä–Ω—É—é –∫–æ–Ω—Å–æ–ª—å

3. **Mock –¥–∞–Ω–Ω—ã–µ –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ Mock CAN
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Ü–µ–ª–µ–π
   - –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å

### –û—Ç–ª–∞–¥–∫–∞

```bash
# –ü–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏
DEBUG=* node integrated-demo.js

# –ü—Ä–æ–≤–µ—Ä–∫–∞ WebSocket
curl -i -N -H "Connection: Upgrade" \
     -H "Upgrade: websocket" \
     -H "Sec-WebSocket-Key: test" \
     -H "Sec-WebSocket-Version: 13" \
     http://localhost:3000
```

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—é
2. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:3000 –≤ –±—Ä–∞—É–∑–µ—Ä–µ
3. –ù–∞–±–ª—é–¥–∞–π—Ç–µ –∑–∞ –¥–≤–∏–∂–µ–Ω–∏–µ–º —Ü–µ–ª–µ–π
4. –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ API —á–µ—Ä–µ–∑ http://localhost:3001

### –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö Mock CAN
2. –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API endpoints
4. –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö

### –î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—é
2. –ü–æ–∫–∞–∂–∏—Ç–µ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
3. –î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –¥–≤–∏–∂–µ–Ω–∏–µ —Ü–µ–ª–µ–π
4. –ü–æ–∫–∞–∂–∏—Ç–µ Emergency Stop –≤ –¥–µ–π—Å—Ç–≤–∏–∏

---

**C.A.R.E.** ‚Äî –ø–æ—Ç–æ–º—É —á—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å **–æ—Å–æ–∑–Ω–∞–Ω–∏—è –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏—è –∂–∏–≤–æ–≥–æ —Ä—è–¥–æ–º**.
