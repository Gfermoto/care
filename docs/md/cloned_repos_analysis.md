# üìã –ê–Ω–∞–ª–∏–∑ —Å–∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ LD2450

## üîç –°–∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

### 1. **HLK-LD2450 Arduino Library** (`ros2/hlk_ld2450_arduino/`)
- **–ê–≤—Ç–æ—Ä**: RBEGamer
- **–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞**: Arduino IDE
- **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**: –ü—Ä–æ—Å—Ç–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è Arduino

#### –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- **–ü—Ä–æ—Å—Ç–æ–π API**: `begin()`, `read()`, `getTarget()`
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö**: `RadarTarget` —Å –ø–æ–ª—è–º–∏ x, y, speed, distance
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞**: HardwareSerial –∏ SoftwareSerial
- **–ü—Ä–∏–º–µ—Ä—ã**: –ë–∞–∑–æ–≤—ã–µ –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è Raspberry Pi Pico

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:
```cpp
typedef struct RadarTarget {
    uint16_t id;             // TARGET ID 1-3
    int16_t x;               // X mm
    int16_t y;               // Y mm
    int16_t speed;           // cm/s
    uint16_t resolution;     // mm
    uint16_t distance;       // mm
    bool valid;              // TRUE IF TARGET DETECTED
} RadarTarget_t;
```

### 2. **LD2450 ESP32 Driver** (`ros2/ld2450_driver_esp32/`)
- **–ê–≤—Ç–æ—Ä**: NieRVoid
- **–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞**: ESP-IDF
- **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**: –ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –¥—Ä–∞–π–≤–µ—Ä –¥–ª—è ESP32

#### –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
- **–ü–æ–ª–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª**: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥ LD2450
- **–ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å**: Thread-safe –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å mutex
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**: –§–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**: –†–µ–≥–∏–æ–Ω—ã, —Ñ–∏–ª—å—Ç—Ä—ã, —Ä–µ–∂–∏–º—ã
- **Callback —Å–∏—Å—Ç–µ–º–∞**: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

#### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
```c
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
esp_err_t ld2450_init(const ld2450_config_t *config);

// Callback –¥–ª—è –¥–∞–Ω–Ω—ã—Ö
esp_err_t ld2450_register_target_callback(ld2450_target_cb_t callback, void *user_ctx);

// –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
esp_err_t ld2450_set_tracking_mode(ld2450_tracking_mode_t mode);
esp_err_t ld2450_set_region_filter(ld2450_filter_type_t type, const ld2450_region_t regions[3]);
```

#### –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö:
```c
typedef struct {
    int16_t x;                // X coordinate (mm)
    int16_t y;                // Y coordinate (mm)
    int16_t speed;            // Speed (cm/s)
    uint16_t resolution;      // Distance resolution (mm)
    float distance;           // Calculated distance (mm)
    float angle;              // Calculated angle in degrees
    bool valid;               // Target validity flag
} ld2450_target_t;

typedef struct {
    ld2450_target_t targets[3];  // Data for up to 3 targets
    uint8_t count;               // Number of valid targets (0-3)
    int64_t timestamp;           // ESP timestamp when data was received
} ld2450_frame_t;
```

## üéØ –ê–Ω–∞–ª–∏–∑ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ C.A.R.E.

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ ESP32 –¥—Ä–∞–π–≤–µ—Ä–∞:
1. **–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–¥**: –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
2. **ESP-IDF —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –ì–æ—Ç–æ–≤ –¥–ª—è PlatformIO
3. **–ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å**: Thread-safe –æ–ø–µ—Ä–∞—Ü–∏–∏
4. **–ì–∏–±–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**: –†–µ–≥–∏–æ–Ω—ã, —Ñ–∏–ª—å—Ç—Ä—ã, —Ä–µ–∂–∏–º—ã
5. **Callback —Å–∏—Å—Ç–µ–º–∞**: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

### –ß—Ç–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
1. **–ë–∞–∑–æ–≤—ã–π –¥—Ä–∞–π–≤–µ—Ä**: –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥ C.A.R.E.
2. **–°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ –æ—Å–Ω–æ–≤—É
3. **–ü—Ä–æ—Ç–æ–∫–æ–ª**: –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥
4. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**: –°–∏—Å—Ç–µ–º–∞ —Ä–µ–≥–∏–æ–Ω–æ–≤ –∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤

### –ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–ª—è C.A.R.E.:
1. **CAN-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–º–∞–Ω–¥ —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
2. **ROS 2 –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**: –ü—É–±–ª–∏–∫–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–æ–ø–∏–∫–∏
3. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –õ–æ–≥–∏–∫–∞ –∑–æ–Ω —Ä–∏—Å–∫–∞ –¥–ª—è –∫–æ–±–æ—Ç–æ–≤
4. **WiFi/Bluetooth**: –ü–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö –≤ ROS 2

## üöÄ –ü–ª–∞–Ω –∞–¥–∞–ø—Ç–∞—Ü–∏–∏

### –≠—Ç–∞–ø 1: –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
1. **–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –¥—Ä–∞–π–≤–µ—Ä** –≤ `esp32/lib/ld2450_driver/`
2. **–ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥ PlatformIO** (CMakeLists.txt)
3. **–î–æ–±–∞–≤–∏—Ç—å CAN-–±–∏–±–ª–∏–æ—Ç–µ–∫—É** (MCP2515/SN65HVD230)
4. **–°–æ–∑–¥–∞—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥** –≤ `esp32/src/main.cpp`

### –≠—Ç–∞–ø 2: CAN-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
1. **–î–æ–±–∞–≤–∏—Ç—å CAN-—Ç—Ä–∞–Ω—Å–∏–≤–µ—Ä** –≤ —Å—Ö–µ–º—É
2. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª** —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
3. **–î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É** –∑–æ–Ω —Ä–∏—Å–∫–∞
4. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** —Å —Ä–µ–∞–ª—å–Ω—ã–º –∫–æ–±–æ—Ç–æ–º

### –≠—Ç–∞–ø 3: ROS 2 –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
1. **–°–æ–∑–¥–∞—Ç—å ROS 2 –ø–∞–∫–µ—Ç** `care_ld2450_driver`
2. **–î–æ–±–∞–≤–∏—Ç—å WiFi/Bluetooth** –ø–µ—Ä–µ–¥–∞—á—É –¥–∞–Ω–Ω—ã—Ö
3. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ç–æ–ø–∏–∫–∏** –¥–ª—è —Ü–µ–ª–µ–π –∏ –∫–æ–º–∞–Ω–¥
4. **–°–æ–∑–¥–∞—Ç—å launch-—Ñ–∞–π–ª—ã** –¥–ª—è –∑–∞–ø—É—Å–∫–∞

## üìÅ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
esp32/
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îú‚îÄ‚îÄ ld2450_driver/          # –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥—Ä–∞–π–≤–µ—Ä
‚îÇ   ‚îî‚îÄ‚îÄ can_transceiver/        # CAN-–±–∏–±–ª–∏–æ—Ç–µ–∫–∞
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ main.cpp                # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥
‚îÇ   ‚îú‚îÄ‚îÄ care_radar.cpp          # –õ–æ–≥–∏–∫–∞ C.A.R.E.
‚îÇ   ‚îî‚îÄ‚îÄ can_safety.cpp          # CAN-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
‚îú‚îÄ‚îÄ include/
‚îÇ   ‚îú‚îÄ‚îÄ care_radar.h
‚îÇ   ‚îî‚îÄ‚îÄ can_safety.h
‚îî‚îÄ‚îÄ platformio.ini              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è PlatformIO
```

## üîß –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å ESP32 –¥—Ä–∞–π–≤–µ—Ä** –ø–æ–¥ PlatformIO
2. **–î–æ–±–∞–≤–∏—Ç—å CAN-–±–∏–±–ª–∏–æ—Ç–µ–∫—É** –¥–ª—è —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
3. **–°–æ–∑–¥–∞—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥** —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
4. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å** —Å —Ä–µ–∞–ª—å–Ω—ã–º LD2450 –º–æ–¥—É–ª–µ–º

---

**–í—ã–≤–æ–¥**: ESP32 –¥—Ä–∞–π–≤–µ—Ä –æ—Ç NieRVoid —è–≤–ª—è–µ—Ç—Å—è –æ—Ç–ª–∏—á–Ω–æ–π –æ—Å–Ω–æ–≤–æ–π –¥–ª—è C.A.R.E. –ø—Ä–æ–µ–∫—Ç–∞. –û–Ω –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ LD2450 –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –ª–µ–≥–∫–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ –Ω–∞—à–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º CAN-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∏ ROS 2 –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞.
